% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\usepackage[utf8]{inputenc}
\DeclareUnicodeCharacter{00A0}{\nobreakspace}
\usepackage[T1]{fontenc}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{longtable}
\usepackage{sphinx}
\usepackage{multirow}


\title{Kerberos Concepts}
\date{ }
\release{1.11.3}
\author{MIT}
\newcommand{\sphinxlogo}{}
\renewcommand{\releasename}{Release}
\makeindex

\makeatletter
\def\PYG@reset{\let\PYG@it=\relax \let\PYG@bf=\relax%
    \let\PYG@ul=\relax \let\PYG@tc=\relax%
    \let\PYG@bc=\relax \let\PYG@ff=\relax}
\def\PYG@tok#1{\csname PYG@tok@#1\endcsname}
\def\PYG@toks#1+{\ifx\relax#1\empty\else%
    \PYG@tok{#1}\expandafter\PYG@toks\fi}
\def\PYG@do#1{\PYG@bc{\PYG@tc{\PYG@ul{%
    \PYG@it{\PYG@bf{\PYG@ff{#1}}}}}}}
\def\PYG#1#2{\PYG@reset\PYG@toks#1+\relax+\PYG@do{#2}}

\def\PYG@tok@gd{\def\PYG@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\def\PYG@tok@gu{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\def\PYG@tok@gt{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.25,0.82}{##1}}}
\def\PYG@tok@gs{\let\PYG@bf=\textbf}
\def\PYG@tok@gr{\def\PYG@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\def\PYG@tok@cm{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\def\PYG@tok@vg{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\def\PYG@tok@m{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\def\PYG@tok@mh{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\def\PYG@tok@cs{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}\def\PYG@bc##1{\colorbox[rgb]{1.00,0.94,0.94}{##1}}}
\def\PYG@tok@ge{\let\PYG@it=\textit}
\def\PYG@tok@vc{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\def\PYG@tok@il{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\def\PYG@tok@go{\def\PYG@tc##1{\textcolor[rgb]{0.19,0.19,0.19}{##1}}}
\def\PYG@tok@cp{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\def\PYG@tok@gi{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\def\PYG@tok@gh{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\def\PYG@tok@ni{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.84,0.33,0.22}{##1}}}
\def\PYG@tok@nl{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.13,0.44}{##1}}}
\def\PYG@tok@nn{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\def\PYG@tok@no{\def\PYG@tc##1{\textcolor[rgb]{0.38,0.68,0.84}{##1}}}
\def\PYG@tok@na{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\def\PYG@tok@nb{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\def\PYG@tok@nc{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\def\PYG@tok@nd{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.33,0.33,0.33}{##1}}}
\def\PYG@tok@ne{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\def\PYG@tok@nf{\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.49}{##1}}}
\def\PYG@tok@si{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.44,0.63,0.82}{##1}}}
\def\PYG@tok@s2{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\def\PYG@tok@vi{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\def\PYG@tok@nt{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.45}{##1}}}
\def\PYG@tok@nv{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\def\PYG@tok@s1{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\def\PYG@tok@gp{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\def\PYG@tok@sh{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\def\PYG@tok@ow{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\def\PYG@tok@sx{\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\def\PYG@tok@bp{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\def\PYG@tok@c1{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\def\PYG@tok@kc{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\def\PYG@tok@c{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\def\PYG@tok@mf{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\def\PYG@tok@err{\def\PYG@bc##1{\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{##1}}}
\def\PYG@tok@kd{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\def\PYG@tok@ss{\def\PYG@tc##1{\textcolor[rgb]{0.32,0.47,0.09}{##1}}}
\def\PYG@tok@sr{\def\PYG@tc##1{\textcolor[rgb]{0.14,0.33,0.53}{##1}}}
\def\PYG@tok@mo{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\def\PYG@tok@mi{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\def\PYG@tok@kn{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\def\PYG@tok@o{\def\PYG@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\def\PYG@tok@kr{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\def\PYG@tok@s{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\def\PYG@tok@kp{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\def\PYG@tok@w{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\def\PYG@tok@kt{\def\PYG@tc##1{\textcolor[rgb]{0.56,0.13,0.00}{##1}}}
\def\PYG@tok@sc{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\def\PYG@tok@sb{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\def\PYG@tok@k{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\def\PYG@tok@se{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\def\PYG@tok@sd{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}

\def\PYGZbs{\char`\\}
\def\PYGZus{\char`\_}
\def\PYGZob{\char`\{}
\def\PYGZcb{\char`\}}
\def\PYGZca{\char`\^}
\def\PYGZsh{\char`\#}
\def\PYGZpc{\char`\%}
\def\PYGZdl{\char`\$}
\def\PYGZti{\char`\~}
% for compatibility with earlier versions
\def\PYGZat{@}
\def\PYGZlb{[}
\def\PYGZrb{]}
\makeatother

\begin{document}

\maketitle
\tableofcontents
\phantomsection\label{basic/index::doc}



\chapter{keytab}
\label{basic/keytab_def:keytab}\label{basic/keytab_def:basic-concepts}\label{basic/keytab_def::doc}\label{basic/keytab_def:keytab-definition}\label{basic/keytab_def:kerberos-v5-concepts}
A keytab (short for ``key table'') stores long-term keys for one or more
principals.  Keytabs are normally represented by files in a standard
format, although in rare cases they can be represented in other ways.
Keytabs are used most often to allow server applications to accept
authentications from clients, but can also be used to obtain initial
credentials for client applications.

Keytabs are named using the format \emph{type}\code{:}\emph{value}.  Usually
\emph{type} is \code{FILE} and \emph{value} is the absolute pathname of the file.
Other possible values for \emph{type} are \code{SRVTAB}, which indicates a
file in the deprecated Kerberos 4 srvtab format, and \code{MEMORY}, which
indicates a temporary keytab stored in the memory of the current
process.

A keytab contains one or more entries, where each entry consists of a
timestamp (indicating when the entry was written to the keytab), a
principal name, a key version number, an encryption type, and the
encryption key itself.

A keytab can be displayed using the \emph{klist(1)} command with the
\code{-k} option.  Keytabs can be created or appended to by extracting
keys from the KDC database using the \emph{kadmin(1)} \emph{ktadd}
command.  Keytabs can be manipulated using the \emph{ktutil(1)} and
\emph{k5srvutil(1)} commands.


\section{Default keytab}
\label{basic/keytab_def:default-keytab}
The default keytab is used by server applications if the application
does not request a specific keytab.  The name of the default keytab is
determined by the following, in decreasing order of preference:
\begin{enumerate}
\item {} 
The \textbf{KRB5\_KTNAME} environment variable.

\item {} 
The \textbf{default\_keytab\_name} profile variable in \emph{libdefaults}.

\item {} 
The hardcoded default, \emph{DEFKTNAME}.

\end{enumerate}


\section{Default client keytab}
\label{basic/keytab_def:default-client-keytab}
The default client keytab is used, if it is present and readable, to
automatically obtain initial credentials for GSSAPI client
applications.  The principal name of the first entry in the client
keytab is used by default when obtaining initial credentials.  The
name of the default client keytab is determined by the following, in
decreasing order of preference:
\begin{enumerate}
\item {} 
The \textbf{KRB5\_CLIENT\_KTNAME} environment variable.

\item {} 
The \textbf{default\_client\_keytab\_name} profile variable in
\emph{libdefaults}.

\item {} 
The hardcoded default, \emph{DEFCKTNAME}.

\end{enumerate}


\chapter{replay cache}
\label{basic/rcache_def:replay-cache}\label{basic/rcache_def:rcache-definition}\label{basic/rcache_def::doc}
A replay cache (or ``rcache'') keeps track of all authenticators
recently presented to a service.  If a duplicate authentication
request is detected in the replay cache, an error message is sent to
the application program.

The replay cache interface, like the credential cache and
{\hyperref[basic/keytab_def:keytab-definition]{\emph{keytab}}} interfaces, uses \emph{type:value} strings to
indicate the type of replay cache and any associated cache naming
data to use.


\section{Background information}
\label{basic/rcache_def:background-information}
Some Kerberos or GSSAPI services use a simple authentication mechanism
where a message is sent containing an authenticator, which establishes
the encryption key that the client will use for talking to the
service.  But nothing about that prevents an eavesdropper from
recording the messages sent by the client, establishing a new
connection, and re-sending or ``replaying'' the same messages; the
replayed authenticator will establish the same encryption key for the
new session, and the following messages will be decrypted and
processed.  The attacker may not know what the messages say, and can't
generate new messages under the same encryption key, but in some
instances it may be harmful to the user (or helpful to the attacker)
to cause the server to see the same messages again a second time.  For
example, if the legitimate client sends ``delete first message in
mailbox'', a replay from an attacker may delete another, different
``first'' message.  (Protocol design to guard against such problems has
been discussed in \index{RFC!RFC 4120\#section-10}\href{http://tools.ietf.org/html/rfc4120.html\#section-10}{\textbf{RFC 4120}}.)

Even if one protocol uses further protection to verify that the client
side of the connection actually knows the encryption keys (and thus is
presumably a legitimate user), if another service uses the same
service principal name, it may be possible to record an authenticator
used with the first protocol and ``replay'' it against the second.

The replay cache mitigates these attacks somewhat, by keeping track of
authenticators that have been seen until their five-minute window
expires.  Different authenticators generated by multiple connections
from the same legitimate client will generally have different
timestamps, and thus will not be considered the same.

This mechanism isn't perfect.  If a message is sent to one application
server but a man-in-the-middle attacker can prevent it from actually
arriving at that server, the attacker could then use the authenticator
(once!) against a different service on the same host.  This could be a
problem if the message from the client included something more than
authentication in the first message that could be useful to the
attacker (which is uncommon; in most protocols the server has to
indicate a successful authentication before the client sends
additional messages), or if the simple act of presenting the
authenticator triggers some interesting action in the service being
attacked.


\section{Default rcache type}
\label{basic/rcache_def:default-rcache-type}
There is currently only one implemented kind of replay cache, called
\textbf{dfl}.  It stores replay data in one file, occasionally rewriting it
to purge old, expired entries.

The default type can be overridden by the \textbf{KRB5RCACHETYPE}
environment variable.

The placement of the replay cache file is determined by the following:
\begin{enumerate}
\item {} 
The \textbf{KRB5RCACHEDIR} environment variable;

\item {} 
If KRB5RCACHEDIR is unspecified, on UNIX, the library
will fall back to the environment variable \textbf{TMPDIR}, and then to
a temporary directory determined at configuration time such as
\emph{/tmp} or \emph{/var/tmp}; on Windows, it will check the environment
variables \emph{TEMP} and \emph{TMP}, and fall back to the directory C:\textbackslash{}.

\end{enumerate}


\section{Performance issues}
\label{basic/rcache_def:performance-issues}
Several known minor performance issues that may occur when replay
cache is enabled on the Kerberos system include: delays due to writing
the authenticator data to disk slowing down response time for very
heavily loaded servers, and delays during the rewrite that may be
unacceptable to high-performance services.

For use cases where replays are adequately defended against for all
protocols using a given service principal name, or where performance
or other considerations outweigh the risk of replays, the special
replay cache type ``none'' can be specified:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{n}{KRB5RCACHETYPE}\PYG{o}{=}\PYG{n}{none}
\end{Verbatim}

It doesn't record any information about authenticators, and reports
that any authenticator seen is not a replay.


\chapter{stash file}
\label{basic/stash_file_def:stash-file}\label{basic/stash_file_def::doc}\label{basic/stash_file_def:stash-definition}
The stash file is a local copy of the master key that resides in
encrypted form on the KDC's local disk.  The stash file is used to
authenticate the KDC to itself automatically before starting the
\emph{kadmind(8)} and \emph{krb5kdc(8)} daemons (e.g., as part of the
machine's boot sequence).  The stash file, like the keytab file (see
\emph{keytab\_file}) is a potential point-of-entry for a break-in, and
if compromised, would allow unrestricted access to the Kerberos
database.  If you choose to install a stash file, it should be
readable only by root, and should exist only on the KDC's local disk.
The file should not be part of any backup of the machine, unless
access to the backup data is secured as tightly as access to the
master password itself.

\begin{notice}{note}{Note:}
If you choose not to install a stash file, the KDC will prompt you for the master key each time it starts up.
This means that the KDC will not be able to start automatically, such as after a system reboot.
\end{notice}


\chapter{Supported date and time formats}
\label{basic/date_format:supported-date-and-time-formats}\label{basic/date_format::doc}\label{basic/date_format:datetime}

\section{Time duration}
\label{basic/date_format:duration}\label{basic/date_format:time-duration}
This format is used to express a time duration in the Kerberos
configuration files and user commands.  The allowed formats are:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|L|}
\hline

Format
 & 
Example
 & 
Value
\\\hline

h:m{[}:s{]}
 & 
36:00
 & 
36 hours
\\\hline

NdNhNmNs
 & 
8h30s
 & 
8 hours 30 seconds
\\\hline

N (number of seconds)
 & 
3600
 & 
1 hour
\\\hline
\end{tabulary}

\end{quote}

Here \emph{N} denotes a number, \emph{d} - days, \emph{h} - hours, \emph{m} - minutes,
\emph{s} - seconds.

\begin{notice}{note}{Note:}
The time interval should not exceed 2147483647 seconds.
\end{notice}

Examples:

\begin{Verbatim}[commandchars=\\\{\}]
Request a ticket valid for one hour, five hours, 30 minutes
and 10 days respectively:

  kinit -l 3600
  kinit -l 5:00
  kinit -l 30m
  kinit -l "10d 0h 0m 0s"
\end{Verbatim}


\section{getdate time}
\label{basic/date_format:getdate-time}\label{basic/date_format:getdate}
Some of the kadmin and kdb5\_util commands take a date-time in a
human-readable format.  Some of the acceptable date-time
strings are:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|L|}
\hline
\textbf{} & \textbf{
Format
} & \textbf{
Example
}\\\hline
 \multirow{3}{*}{
Date
} & 
mm/dd/yy
 & 
07/27/12
\\

month dd, yyyy
 & 
Jul 27, 2012
\\\hline

yyyy-mm-dd
 & 
2012-07-27
\\\hline
 \multirow{2}{*}{
Absolute
time
} & 
HH:mm{[}:ss{]}pp
 & 
08:30 PM
\\

hh:mm{[}:ss{]}
 & 
20:30
\\\hline

Relative
time
 & 
N tt
 & 
30 sec
\\\hline
 \multirow{2}{*}{
Time zone
} & 
Z
 & 
EST
\\

z
 & 
-0400
\\\hline
\end{tabulary}

\end{quote}

(See {\hyperref[basic/date_format:abbreviation]{\emph{Abbreviations used in this document}}}.)

Examples:

\begin{Verbatim}[commandchars=\\\{\}]
Create a principal that expires on the date indicated:
    addprinc test1 -expire "3/27/12 10:00:07 EST"
    addprinc test2 -expire "January 23, 2015 10:05pm"
    addprinc test3 -expire "22:00 GMT"
Add a principal that will expire in 30 minutes:
    addprinc test4 -expire "30 minutes"
\end{Verbatim}


\section{Absolute time}
\label{basic/date_format:abstime}\label{basic/date_format:absolute-time}
This rarely used date-time format can be noted in one of the
following ways:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|L|}
\hline
\textbf{
Format
} & \textbf{
Example
} & \textbf{
Value
}\\\hline

yyyymmddhhmmss
 & 
20141231235900
 &  \multirow{5}{*}{
One minute
before 2015
}\\

yyyy.mm.dd.hh.mm.ss
 & 
2014.12.31.23.59.00
 & \\\hline

yymmddhhmmss
 & 
141231235900
 & \\\hline

yy.mm.dd.hh.mm.ss
 & 
14.12.31.23.59.00
 & \\\hline

dd-month-yyyy:hh:mm:ss
 & 
31-Dec-2014:23:59:00
 & \\\hline

hh:mm:ss
 & 
20:00:00
 &  \multirow{2}{*}{
8 o'clock in
the evening
}\\

hhmmss
 & 
200000
 & \\\hline
\end{tabulary}

\end{quote}

(See {\hyperref[basic/date_format:abbreviation]{\emph{Abbreviations used in this document}}}.)

Example

\begin{Verbatim}[commandchars=\\\{\}]
Set the default expiration date to July 27, 2012 at 20:30
default\_principal\_expiration = 20120727203000
\end{Verbatim}


\subsection{Abbreviations used in this document}
\label{basic/date_format:abbreviation}\label{basic/date_format:abbreviations-used-in-this-document}
\begin{DUlineblock}{0em}
\item[] \emph{month}  : localeâ€™s month name or its abbreviation;
\item[] \emph{dd}   : day of month (01-31);
\item[] \emph{HH}   : hours (00-12);
\item[] \emph{hh}   : hours (00-23);
\item[] \emph{mm}   : in time - minutes (00-59); in date - month (01-12);
\item[] \emph{N}    : number;
\item[] \emph{pp}   : AM or PM;
\item[] \emph{ss}   : seconds  (00-60);
\item[] \emph{tt}   : time units (hours, minutes, min, seconds, sec);
\item[] \emph{yyyy} : year;
\item[] \emph{yy}   : last two digits of the year;
\item[] \emph{Z}    : alphabetic time zone abbreviation;
\item[] \emph{z}    : numeric time zone;
\end{DUlineblock}

\begin{notice}{note}{Note:}\begin{itemize}
\item {} 
If the date specification contains spaces, you may need to
enclose it in double quotes;

\item {} 
All keywords are case-insensitive.

\end{itemize}
\end{notice}



\renewcommand{\indexname}{Index}
\printindex
\end{document}
